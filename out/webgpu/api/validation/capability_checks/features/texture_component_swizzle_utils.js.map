{"version":3,"file":"texture_component_swizzle_utils.js","names":["kSwizzleTests","kSwizzleLetterToComponent","u","undefined","r","g","b","a","kComponents","swizzleSpecToGPUTextureComponentSwizzle","spec","swizzle","forEach","component","i","v","swizzleComponentToTexelComponent","src","R","G","B","A","swizzleTexel","isIdentitySwizzle","normalizeSwizzle","swizzlesAreTheSame"],"sources":["../../../../../../src/webgpu/api/validation/capability_checks/features/texture_component_swizzle_utils.ts"],"sourcesContent":["import { PerTexelComponent } from '../../../../util/texture/texel_data.js';\n\ndeclare global {\n  // MAINTENANCE_TODO: Remove these types once texture-component-swizzle is added to @webgpu/types\n  /* prettier-ignore */\n  type GPUComponentSwizzle =\n    | 'zero' // Force its value to 0.\n    | 'one'  // Force its value to 1.\n    | 'r'    // Take its value from the red channel of the texture.\n    | 'g'    // Take its value from the green channel of the texture.\n    | 'b'    // Take its value from the blue channel of the texture.\n    | 'a'    // Take its value from the alpha channel of the texture.\n    ;\n\n  type GPUTextureComponentSwizzle = {\n    r?: GPUComponentSwizzle;\n    g?: GPUComponentSwizzle;\n    b?: GPUComponentSwizzle;\n    a?: GPUComponentSwizzle;\n  };\n\n  interface GPUTextureViewDescriptor {\n    swizzle?: GPUTextureComponentSwizzle | undefined;\n  }\n}\n\n// Note: There are 4 settings with 7 options each including undefined\n// which is 2401 combinations. So we don't check them all. Just a few below.\nexport const kSwizzleTests = [\n  'uuuu',\n  'rgba',\n  '0000',\n  '1111',\n  'rrrr',\n  'gggg',\n  'bbbb',\n  'aaaa',\n  'abgr',\n  'gbar',\n  'barg',\n  'argb',\n  '0gba',\n  'r0ba',\n  'rg0a',\n  'rgb0',\n  '1gba',\n  'r1ba',\n  'rg1a',\n  'rgb1',\n  'ubga',\n  'ruga',\n  'rbua',\n  'rbgu',\n] as const;\nexport type SwizzleSpec = (typeof kSwizzleTests)[number];\n\nconst kSwizzleLetterToComponent: Record<string, GPUComponentSwizzle | undefined> = {\n  u: undefined,\n  r: 'r',\n  g: 'g',\n  b: 'b',\n  a: 'a',\n  '0': 'zero',\n  '1': 'one',\n} as const;\n\nconst kComponents = ['r', 'g', 'b', 'a'] as const;\n\nexport function swizzleSpecToGPUTextureComponentSwizzle(spec: string): GPUTextureComponentSwizzle {\n  const swizzle: Record<string, string> = {};\n  kComponents.forEach((component, i) => {\n    const v = kSwizzleLetterToComponent[spec[i]];\n    if (v) {\n      swizzle[component] = v;\n    }\n  });\n  return swizzle as GPUTextureComponentSwizzle;\n}\n\nfunction swizzleComponentToTexelComponent(\n  src: PerTexelComponent<number>,\n  component: GPUComponentSwizzle\n): number {\n  switch (component) {\n    case 'zero':\n      return 0;\n    case 'one':\n      return 1;\n    case 'r':\n      return src.R!;\n    case 'g':\n      return src.G!;\n    case 'b':\n      return src.B!;\n    case 'a':\n      return src.A!;\n  }\n}\n\nexport function swizzleTexel(\n  src: PerTexelComponent<number>,\n  swizzle: GPUTextureComponentSwizzle\n): PerTexelComponent<number> {\n  return {\n    R: swizzle.r ? swizzleComponentToTexelComponent(src, swizzle.r) : src.R,\n    G: swizzle.g ? swizzleComponentToTexelComponent(src, swizzle.g) : src.G,\n    B: swizzle.b ? swizzleComponentToTexelComponent(src, swizzle.b) : src.B,\n    A: swizzle.a ? swizzleComponentToTexelComponent(src, swizzle.a) : src.A,\n  };\n}\n\nexport function isIdentitySwizzle(swizzle: GPUTextureComponentSwizzle): boolean {\n  return (\n    (swizzle.r === undefined || swizzle.r === 'r') &&\n    (swizzle.g === undefined || swizzle.g === 'g') &&\n    (swizzle.b === undefined || swizzle.b === 'b') &&\n    (swizzle.a === undefined || swizzle.a === 'a')\n  );\n}\n\nfunction normalizeSwizzle(swizzle: GPUTextureComponentSwizzle): GPUTextureComponentSwizzle {\n  return {\n    r: swizzle.r ?? 'r',\n    g: swizzle.g ?? 'g',\n    b: swizzle.b ?? 'b',\n    a: swizzle.a ?? 'a',\n  };\n}\n\nexport function swizzlesAreTheSame(\n  a: GPUTextureComponentSwizzle,\n  b: GPUTextureComponentSwizzle\n): boolean {\n  a = normalizeSwizzle(a);\n  b = normalizeSwizzle(b);\n  return a.r === b.r && a.g === b.g && a.b === b.b && a.a === b.a;\n}\n"],"mappings":"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"}